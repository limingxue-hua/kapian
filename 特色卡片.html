KPI_SVG访问用户数 = 
VAR _value        = FORMAT([访问总用户数], "#,##0")
VAR _samePeriod   =IF(ISBLANK([访问总用户数去年同期]),"无数据",FORMAT ([访问总用户数去年同期], "#,##0" ))
VAR _lastMonth    = FORMAT ([访问总用户数上月], "#,##0" )
VAR _lastWeek    = FORMAT ([访问总用户数上周], "#,##0" )
VAR _yoyText = IF(ISBLANK([访问总用户数去年同期]),"无数据",FORMAT ( [访问总用户数同比], "+0.0%;-0.0%;0%" ))
VAR _momText = FORMAT ( [访问总用户数环比], "+0.0%;-0.0%" )
VAR _wowText = FORMAT ( [访问总用户数周环比], "+0.0%;-0.0%" )
VAR _yoyArrow = IF ( [访问总用户数同比] >= 0, "▲", "▼" )
VAR _momArrow = IF ( [访问总用户数环比] >= 0, "▲", "▼" )
VAR _wowArrow = IF ( [访问总用户数周环比]>= 0, "▲", "▼" )
RETURN
"<svg width='460' height='220' viewBox='0 0 460 220' xmlns='http://www.w3.org/2000/svg'>
  <defs>
    <linearGradient id='bgMix' x1='0%' y1='0%' x2='100%' y2='100%'>
      <stop offset='0%' stop-color='#e6ffe9'/>
      <stop offset='35%' stop-color='#dde9ff'/>
      <stop offset='65%' stop-color='#e6ffe9'/>
      <stop offset='100%' stop-color='#dde9ff'/>
    </linearGradient>
    <pattern id='softStripes' width='8' height='8' patternUnits='userSpaceOnUse'>
      <line x1='0' y1='8' x2='8' y2='0'
            stroke='#ffffff' stroke-opacity='0.3' stroke-width='1'/>
    </pattern>
    <filter id='cardShadow' x='-20%' y='-20%' width='140%' height='140%'>
      <feDropShadow dx='0' dy='8' stdDeviation='12'
                    flood-color='#000' flood-opacity='0.16'/>
    </filter>
    <filter id='innerShadow' x='-20%' y='-20%' width='140%' height='140%'>
      <feDropShadow dx='0' dy='4' stdDeviation='8'
                    flood-color='#000' flood-opacity='0.1'/>
    </filter>
  </defs>
  <!-- 外层卡片 -->
  <rect x='8' y='8' width='444' height='204' rx='18'
        fill='url(#bgMix)' filter='url(#cardShadow)'/>
  <rect x='8' y='8' width='444' height='204' rx='18'
        fill='url(#softStripes)' opacity='0.22'/>
  <!-- 倾斜数据背景框 -->
  <g transform='rotate(-1 230 110)'>
    <rect x='28' y='30' width='404' height='160' rx='18'
          fill='#f2fcf7' filter='url(#innerShadow)'/>
  </g>
  <!-- 标题 -->
  <text x='50' y='56' font-size='20' fill='#2f4f4f' font-weight='600'>
    总访问用户数
  </text>
  <!-- 本期 -->
  <text x='50' y='94' font-size='40' fill='#0f5132' font-weight='800'>
    " & _value & "
  </text>
  <text x='160' y='94' font-size='20' fill='#0f5132' font-weight='700'>本期</text>
  <!-- 同期 -->
  <text x='50' y='122' font-size='18' fill='#355070'>同期</text>
  <text x='95' y='122' font-size='20' fill='#1f3c88' font-weight='700'>
    " & _samePeriod & "
  </text>
  <!-- 上月 -->
  <text x='210' y='122' font-size='18' fill='#355070'>上月</text>
  <text x='245' y='122' font-size='20' fill='#1f3c88' font-weight='700'>
    " & _lastMonth & "
  </text>
<!-- 上周 -->
  <text x='330' y='122' font-size='18' fill='#355070'>上周</text>
  <text x='365' y='122' font-size='20' fill='#1f3c88' font-weight='700'>
    " & _lastWeek & "
  </text>
  <!-- 分隔线 -->
  <line x1='50' y1='136' x2='410' y2='136' stroke='#cfe8dc'/>
  <!-- 同比 -->
  <text x='50' y='158' font-size='18' fill='#14532d'>
    " & _yoyArrow & " 同比
  </text>
  <text x='50' y='178' font-size='20' fill='#22c55e' font-weight='700'>
    " & _yoyText & "
  </text>
  <!-- 环比 -->
  <text x='210' y='158' font-size='18' fill='#78350f'>
    " & _momArrow & " 环比
  </text>
  <text x='210' y='178' font-size='20' fill='#f59e0b' font-weight='700'>
    " & _momText & "
  </text>
  <!-- 周环比 -->
  <text x='330' y='158' font-size='18' fill='#1e3a8a'>
    " & _wowArrow & " 周环比
  </text>
  <text x='330' y='178' font-size='20' fill='#3b82f6' font-weight='700'>
    " & _wowText & "
  </text>
</svg>"
