<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Power BI SVG DAX å¤‡ä»½</title>
<style>
body {margin:0;font-family: Consolas, 'Segoe UI', Arial, sans-serif; background:#f3f4f6;}
.header {
  padding:16px 20px;
  background:#1f2937;
  color:white;
  font-size:18px;}
.container { padding:16px;}
textarea {
  width:100%;
  height:90vh;
  padding:16px;
  box-sizing:border-box;
  font-family: Consolas, monospace;
  font-size:13px;
  border-radius:8px;
  border:1px solid #d1d5db;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
  white-space: pre;}
.note {margin-bottom:10px;color:#374151;}
</style>
</head>
<body>
<div class="header">ğŸ“„ Power BI SVG / DAX å¤‡ä»½ï¼ˆå¿…å®šåªå±•ç¤ºæ–‡æœ¬ï¼‰</div>
<div class="container">
<div class="note">ğŸ‘‰ è¿™é‡Œ**æ°¸è¿œä¸ä¼šæ¸²æŸ“æˆå›¾ç‰‡**ï¼šå…¨é€‰ â†’ å¤åˆ¶ â†’ ç²˜å› Power BI</div>
<textarea>


KPI_SVGè®¿é—®ç”¨æˆ·æ•° = 
VAR _value        = FORMAT([è®¿é—®æ€»ç”¨æˆ·æ•°], "#,##0")
VAR _samePeriod   =IF(ISBLANK([è®¿é—®æ€»ç”¨æˆ·æ•°å»å¹´åŒæœŸ]),"æ— æ•°æ®",FORMAT ([è®¿é—®æ€»ç”¨æˆ·æ•°å»å¹´åŒæœŸ], "#,##0" ))
VAR _lastMonth    = FORMAT ([è®¿é—®æ€»ç”¨æˆ·æ•°ä¸Šæœˆ], "#,##0" )
VAR _lastWeek    = FORMAT ([è®¿é—®æ€»ç”¨æˆ·æ•°ä¸Šå‘¨], "#,##0" )
VAR _yoyText = IF(ISBLANK([è®¿é—®æ€»ç”¨æˆ·æ•°å»å¹´åŒæœŸ]),"æ— æ•°æ®",FORMAT ( [è®¿é—®æ€»ç”¨æˆ·æ•°åŒæ¯”], "+0.0%;-0.0%;0%" ))
VAR _momText = FORMAT ( [è®¿é—®æ€»ç”¨æˆ·æ•°ç¯æ¯”], "+0.0%;-0.0%" )
VAR _wowText = FORMAT ( [è®¿é—®æ€»ç”¨æˆ·æ•°å‘¨ç¯æ¯”], "+0.0%;-0.0%" )
VAR _yoyArrow = IF ( [è®¿é—®æ€»ç”¨æˆ·æ•°åŒæ¯”] >= 0, "â–²", "â–¼" )
VAR _momArrow = IF ( [è®¿é—®æ€»ç”¨æˆ·æ•°ç¯æ¯”] >= 0, "â–²", "â–¼" )
VAR _wowArrow = IF ( [è®¿é—®æ€»ç”¨æˆ·æ•°å‘¨ç¯æ¯”]>= 0, "â–²", "â–¼" )
RETURN
"<svg width='460' height='220' viewBox='0 0 460 220' xmlns='http://www.w3.org/2000/svg'>
  <defs>
    <linearGradient id='bgMix' x1='0%' y1='0%' x2='100%' y2='100%'>
      <stop offset='0%' stop-color='#e6ffe9'/>
      <stop offset='35%' stop-color='#dde9ff'/>
      <stop offset='65%' stop-color='#e6ffe9'/>
      <stop offset='100%' stop-color='#dde9ff'/>
    </linearGradient>
    <pattern id='softStripes' width='8' height='8' patternUnits='userSpaceOnUse'>
      <line x1='0' y1='8' x2='8' y2='0'
            stroke='#ffffff' stroke-opacity='0.3' stroke-width='1'/>
    </pattern>
    <filter id='cardShadow' x='-20%' y='-20%' width='140%' height='140%'>
      <feDropShadow dx='0' dy='8' stdDeviation='12'
                    flood-color='#000' flood-opacity='0.16'/>
    </filter>
    <filter id='innerShadow' x='-20%' y='-20%' width='140%' height='140%'>
      <feDropShadow dx='0' dy='4' stdDeviation='8'
                    flood-color='#000' flood-opacity='0.1'/>
    </filter>
  </defs>
  <!-- å¤–å±‚å¡ç‰‡ -->
  <rect x='8' y='8' width='444' height='204' rx='18'
        fill='url(#bgMix)' filter='url(#cardShadow)'/>
  <rect x='8' y='8' width='444' height='204' rx='18'
        fill='url(#softStripes)' opacity='0.22'/>
  <!-- å€¾æ–œæ•°æ®èƒŒæ™¯æ¡† -->
  <g transform='rotate(-1 230 110)'>
    <rect x='28' y='30' width='404' height='160' rx='18'
          fill='#f2fcf7' filter='url(#innerShadow)'/>
  </g>
  <!-- æ ‡é¢˜ -->
  <text x='50' y='56' font-size='20' fill='#2f4f4f' font-weight='600'>
    æ€»è®¿é—®ç”¨æˆ·æ•°
  </text>
  <!-- æœ¬æœŸ -->
  <text x='50' y='94' font-size='40' fill='#0f5132' font-weight='800'>
    " & _value & "
  </text>
  <text x='160' y='94' font-size='20' fill='#0f5132' font-weight='700'>æœ¬æœŸ</text>
  <!-- åŒæœŸ -->
  <text x='50' y='122' font-size='18' fill='#355070'>åŒæœŸ</text>
  <text x='95' y='122' font-size='20' fill='#1f3c88' font-weight='700'>
    " & _samePeriod & "
  </text>
  <!-- ä¸Šæœˆ -->
  <text x='210' y='122' font-size='18' fill='#355070'>ä¸Šæœˆ</text>
  <text x='245' y='122' font-size='20' fill='#1f3c88' font-weight='700'>
    " & _lastMonth & "
  </text>
<!-- ä¸Šå‘¨ -->
  <text x='330' y='122' font-size='18' fill='#355070'>ä¸Šå‘¨</text>
  <text x='365' y='122' font-size='20' fill='#1f3c88' font-weight='700'>
    " & _lastWeek & "
  </text>
  <!-- åˆ†éš”çº¿ -->
  <line x1='50' y1='136' x2='410' y2='136' stroke='#cfe8dc'/>
  <!-- åŒæ¯” -->
  <text x='50' y='158' font-size='18' fill='#14532d'>
    " & _yoyArrow & " åŒæ¯”
  </text>
  <text x='50' y='178' font-size='20' fill='#22c55e' font-weight='700'>
    " & _yoyText & "
  </text>
  <!-- ç¯æ¯” -->
  <text x='210' y='158' font-size='18' fill='#78350f'>
    " & _momArrow & " ç¯æ¯”
  </text>
  <text x='210' y='178' font-size='20' fill='#f59e0b' font-weight='700'>
    " & _momText & "
  </text>
  <!-- å‘¨ç¯æ¯” -->
  <text x='330' y='158' font-size='18' fill='#1e3a8a'>
    " & _wowArrow & " å‘¨ç¯æ¯”
  </text>
  <text x='330' y='178' font-size='20' fill='#3b82f6' font-weight='700'>
    " & _wowText & "
  </text>
</svg>"

</textarea>
</div>
</body>
</html>
